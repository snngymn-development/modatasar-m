# Cursor AI TalimatlarÄ± - Deneme1 Projesi

## ğŸ¯ Proje YapÄ±sÄ±

Bu proje **Clean Core Architecture** + **Domain Driven Design (DDD)** prensiplerine gÃ¶re organize edilmiÅŸ TypeScript monorepo'dur.

## ğŸ“ Katman YapÄ±sÄ±

```
packages/core     â†’ Domain Layer (Pure business logic)
packages/shared   â†’ Application Layer (Re-exports from core)
backend/api       â†’ Infrastructure Layer (NestJS + Prisma)
frontend/web      â†’ Presentation Layer (React + Vite)
frontend/mobile   â†’ Presentation Layer (React Native)
```

## ğŸ¨ Yeni Dosya OluÅŸtururken

### Domain Entity (packages/core/src/entities/)
```typescript
// Ã–rnek: packages/core/src/entities/Product.ts
import type { ID, Currency } from '../types/common'

export interface Product {
  id: ID
  name: string
  price: Currency  // cents
  stock: number
}
```

### Validation Schema (packages/core/src/validation/)
```typescript
// Ã–rnek: packages/core/src/validation/product.schema.ts
import { z } from 'zod'

export const ProductSchema = z.object({
  id: z.string(),
  name: z.string().min(1),
  price: z.number().positive(),
  stock: z.number().int().nonnegative()
})
```

### Backend Module (backend/api/src/modules/)
```
modules/products/
â”œâ”€â”€ products.module.ts      # Module definition
â”œâ”€â”€ products.controller.ts  # REST endpoints with @ApiTags, @ApiOperation
â”œâ”€â”€ products.service.ts     # Business logic + Prisma
â””â”€â”€ dto.ts                  # DTOs with @ApiProperty
```

### Frontend Component (frontend/web/src/components/)
```typescript
// Ã–rnek: frontend/web/src/components/ProductCard.tsx
import React from 'react'
import { fmtTRY } from '@core/utils/money'
import type { Product } from '@shared'

export function ProductCard({ product }: { product: Product }) {
  return (
    <div>
      <h3>{product.name}</h3>
      <p>{fmtTRY(product.price)}</p>  {/* cents auto-converted */}
    </div>
  )
}
```

## ğŸš« YAPMA (Don'ts)

âŒ Domain logic'i frontend'e yazma  
âŒ Business logic'i controller'a yazma  
âŒ `any` type kullanma  
âŒ Validation'Ä± atlama  
âŒ Para formatÄ±nda manuel /100 yapma (fmtTRY iÃ§inde yapÄ±lÄ±yor)

## âœ… YAP (Do's)

âœ… Domain logic'i `packages/core` iÃ§inde tut  
âœ… TypeScript strict mode kullan  
âœ… Zod ile validation yap  
âœ… Prisma migrations kullan  
âœ… RESTful API tasarla  
âœ… Swagger documentation gÃ¼ncelle (`@ApiOperation`, `@ApiProperty`)  
âœ… Para tutarlarÄ±nÄ± cents (Int) olarak sakla  
âœ… `fmtTRY(cents)` ile gÃ¶ster (otomatik TL'ye Ã§evirir)

## ğŸ’° Para (Currency) KurallarÄ±

**Ã–NEMLÄ°:** Database'de para **cents** (kuruÅŸ) olarak saklanÄ±r!

```typescript
// Database
total: 10000      // 100.00 TL (cents)

// Display
fmtTRY(total)     // "â‚º100" (otomatik /100 yapÄ±lÄ±r)

// âŒ YAPMA
fmtTRY(total / 100)  // Ã‡ifte bÃ¶lme hatasÄ±!

// âœ… YAP
fmtTRY(total)        // Utility fonksiyon halledecek
```

## ğŸ—‚ï¸ Path Aliases

```typescript
// Backend
import { PrismaService } from '../../common/prisma.service'  // Relative path OK

// Frontend
import { api } from '@/lib/api'                    // @ = src/
import { Customer } from '@shared'                 // @shared = packages/shared
import { fmtTRY } from '@core/utils/money'        // @core = packages/core
```

## ğŸ”Œ API Endpoint Pattern

```typescript
@ApiTags('products')
@Controller('products')
export class ProductsController {
  constructor(private readonly service: ProductsService) {}

  @Get()
  @ApiOperation({ summary: 'Get all products' })
  @ApiResponse({ status: 200, description: 'Return all products' })
  findAll() {
    return this.service.findAll()
  }

  @Post()
  @ApiOperation({ summary: 'Create product' })
  create(@Body() dto: CreateProductDto) {
    return this.service.create(dto)
  }
}
```

## ğŸ—ƒï¸ Database Pattern (Prisma)

```prisma
model Product {
  id        String   @id @default(cuid())
  name      String
  price     Int      // âš ï¸ Cents, not TL!
  stock     Int
  createdAt DateTime @default(now())
}
```

After schema change:
```bash
npx prisma migrate dev --name add_products
pnpm prisma:gen
```

## ğŸ“ Validation Pattern

```typescript
// Backend DTO
export class CreateProductDto {
  @ApiProperty()
  @IsString()
  @MinLength(1)
  name: string

  @ApiProperty()
  @IsNumber()
  @Min(0)
  price: number
}

// Frontend validation (same Zod schema from @shared)
import { ProductSchema } from '@shared'

const result = ProductSchema.safeParse(formData)
```

## ğŸŒ i18n Pattern

```typescript
// Add translations
// packages/core/src/i18n/tr.ts
export default {
  products: {
    title: 'ÃœrÃ¼nler',
    add: 'Yeni ÃœrÃ¼n Ekle'
  }
}

// Usage
import { TEXT } from '@shared'
const title = TEXT.tr.products.title
```

## ğŸ“Š ModÃ¼l Ekleme Checklist

Yeni modÃ¼l (Ã¶rn: Products) eklerken:

- [ ] Domain entity (`packages/core/src/entities/Product.ts`)
- [ ] Validation schema (`packages/core/src/validation/product.schema.ts`)
- [ ] Export from validation index
- [ ] Prisma model (`backend/api/prisma/schema.prisma`)
- [ ] Run migration (`npx prisma migrate dev`)
- [ ] NestJS module (`backend/api/src/modules/products/`)
  - [ ] products.module.ts
  - [ ] products.controller.ts (with Swagger decorators)
  - [ ] products.service.ts
  - [ ] dto.ts (with @ApiProperty)
- [ ] Import module in AppModule
- [ ] Frontend API calls (`frontend/web/src/lib/api.ts`)
- [ ] Frontend components
- [ ] i18n translations (TR/EN)

## ğŸ—ï¸ Dependency Rules

```
frontend/* â†’ @shared â†’ @core
backend/api â†’ @core (for types only, not logic)
packages/core â†’ NO dependencies (pure domain)
```

## ğŸ“– Referans Dosyalar

- **COMPLETE_GUIDE.md** - Eksiksiz rehber (2400+ satÄ±r)
- **CRITICAL_FIXES.md** - Kritik dÃ¼zeltmeler
- **Swagger** - http://localhost:3000/docs

## ğŸ¯ GeliÅŸtirme KomutlarÄ±

```bash
# Development
pnpm dev:api       # Backend
pnpm dev:web       # Frontend
pnpm dev:mobile    # Mobile

# Database
pnpm prisma:gen
pnpm prisma:migrate
pnpm prisma:seed

# Build
pnpm build

# OpenAPI
pnpm codegen
```

## ğŸ”§ Troubleshooting

**Type errors?** â†’ Rebuild packages
```bash
pnpm --filter @deneme1/core build
pnpm --filter @deneme1/shared build
```

**Database issues?** â†’ Reset
```bash
pnpm --filter @deneme1/api prisma migrate reset
```

**Import errors?** â†’ Check aliases in:
- tsconfig.base.json
- vite.config.ts
- metro.config.js

---

**Bu dosya Cursor AI'Ä±n projeyi doÄŸru anlamasÄ± iÃ§in talimatlar iÃ§erir.**
**Her yeni kod Ã¼retiminde bu kurallara uyulmalÄ±dÄ±r.**


