# Database Performance Guide ## Performance Targets - **p95 Query Time**: < 100ms - **p99 Query Time**: < 500ms - **Connection Pool**: 10-20 connections - **Query Timeout**: 30 seconds ## Indexes ### Critical Indexes ```sql -- Users table CREATE INDEX idx_users_email ON users(email); CREATE INDEX idx_users_tenant_id ON users(tenant_id); -- Orders table CREATE INDEX idx_orders_created_at ON orders(created_at); CREATE INDEX idx_orders_user_id ON orders(user_id); CREATE INDEX idx_orders_status ON orders(status); -- Products table CREATE INDEX idx_products_name ON products(name); CREATE INDEX idx_products_category ON products(category); ``` ## Query Optimization ### Common Patterns 1. **Use EXPLAIN ANALYZE** for slow queries 2. **Avoid SELECT \*** - specify columns 3. **Use LIMIT** for pagination 4. **Index foreign keys** 5. **Use prepared statements** ## Monitoring - **Slow Query Log**: Enable in PostgreSQL - **Connection Metrics**: Track pool usage - **Query Performance**: Monitor execution times ## Performance Testing ```bash # Run performance tests npm run test:perf # Database load testing npm run test:db-load ```